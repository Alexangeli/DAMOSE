<!DOCTYPE HTML>
<html lang="it">
<head>
<!-- Generated by javadoc (25) on Wed Feb 18 03:54:42 CET 2026 -->
<title>MapController</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2026-02-18">
<meta name="description" content="declaration: package: Controller.Map, class: MapController">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../script-files/script.js"></script>
<script type="text/javascript" src="../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/MapController.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../search.html">Search</a></li>
<li><a href="../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">Controller.Map</a></li>
<li><a href="MapController.html" class="current-selection">MapController</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#constructor-summary" tabindex="0">Constructor Summary</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#constructor-detail" tabindex="0">Constructor Details</a>
<ol class="toc-list">
<li><a href="#%3Cinit%3E(Model.Map.MapModel,View.Map.MapView,java.lang.String,Service.GTFS_RT.Fetcher.Vehicle.VehiclePositionsService)" tabindex="0">MapController(MapModel, MapView, String, VehiclePositionsService)</a></li>
</ol>
</li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#centerMapOnStop(Model.Points.StopModel)" tabindex="0">centerMapOnStop(StopModel)</a></li>
<li><a href="#centerMapOnGtfsStop(Model.Points.StopModel)" tabindex="0">centerMapOnGtfsStop(StopModel)</a></li>
<li><a href="#centerMapOnCluster(Model.Points.ClusterModel)" tabindex="0">centerMapOnCluster(ClusterModel)</a></li>
<li><a href="#refreshView()" tabindex="0">refreshView()</a></li>
<li><a href="#clearRouteHighlight()" tabindex="0">clearRouteHighlight()</a></li>
<li><a href="#hideUselessStops(java.util.List)" tabindex="0">hideUselessStops(List)</a></li>
<li><a href="#showAllStops()" tabindex="0">showAllStops()</a></li>
<li><a href="#highlightRouteAllDirections(java.lang.String)" tabindex="0">highlightRouteAllDirections(String)</a></li>
<li><a href="#highlightRouteFitLine(java.lang.String,java.lang.String)" tabindex="0">highlightRouteFitLine(String, String)</a></li>
<li><a href="#highlightRouteKeepStopView(java.lang.String,java.lang.String)" tabindex="0">highlightRouteKeepStopView(String, String)</a></li>
<li><a href="#highlightRouteAllDirectionsKeepStopView(java.lang.String)" tabindex="0">highlightRouteAllDirectionsKeepStopView(String)</a></li>
<li><a href="#showVehiclesForRoute(java.lang.String,int)" tabindex="0">showVehiclesForRoute(String, int)</a></li>
<li><a href="#clearVehicles()" tabindex="0">clearVehicles()</a></li>
<li><a href="#refreshVehiclesLayerIfNeeded()" tabindex="0">refreshVehiclesLayerIfNeeded()</a></li>
<li><a href="#clearHighlightedStop()" tabindex="0">clearHighlightedStop()</a></li>
<li><a href="#bindConnectionStatus(Model.Net.ConnectionStatusProvider)" tabindex="0">bindConnectionStatus(ConnectionStatusProvider)</a></li>
</ol>
</li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class MapController" class="title">Class MapController</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">Controller.Map.MapController</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">MapController</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Controller della mappa basato su JXMapViewer.

Responsabilità:
- Caricare le fermate (da CSV GTFS statico) e trasformarle in <a href="../../View/Waypointers/Waypoint/StopWaypoint.html" title="class in View.Waypointers.Waypoint"><code>StopWaypoint</code></a>.
- Gestire interazioni utente: drag, zoom smooth, click su mappa/marker.
- Applicare clustering delle fermate in base allo zoom, per evitare sovrapposizioni.
- Gestire l’evidenziazione di una linea (shapes) e di una fermata selezionata.
- Mostrare (opzionalmente) i veicoli realtime filtrati per route/direction.

Note di design:
- Le fermate "di base" sono caricate una volta e mantenute in <code>waypoints</code>.
- In modalità zoom alto (più “lontano”), le fermate vengono raggruppate in cluster tramite <a href="../../Service/Points/ClusterService.html" title="class in Service.Points"><code>ClusterService</code></a>.
- Per la UX lo zoom è “smooth”: la rotellina cambia <code>targetZoom</code> e un timer applica step graduali.
- La fermata evidenziata resta visibile anche quando la mappa è in modalità cluster.

Aspetti UI:
- Questo controller aggiorna direttamente <a href="../../View/Map/MapView.html" title="class in View.Map"><code>MapView</code></a> tramite <a href="#refreshView()"><code>refreshView()</code></a>.
- In caso di OFFLINE, la mappa può passare a tile “offline only” e la layer realtime (veicoli) viene disattivata.

Creatori: Simone Bonuso, Andrea Brandolini, Alessandro Angeli</div>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(Model.Map.MapModel,View.Map.MapView,java.lang.String,Service.GTFS_RT.Fetcher.Vehicle.VehiclePositionsService)" class="member-name-link">MapController</a><wbr>(<a href="../../Model/Map/MapModel.html" title="class in Model.Map">MapModel</a>&nbsp;model,
 <a href="../../View/Map/MapView.html" title="class in View.Map">MapView</a>&nbsp;view,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;stopsCsvPath,
 <a href="../../Service/GTFS_RT/Fetcher/Vehicle/VehiclePositionsService.html" title="class in Service.GTFS_RT.Fetcher.Vehicle">VehiclePositionsService</a>&nbsp;vehiclePositionsService)</code></div>
<div class="col-last even-row-color">
<div class="block">Crea il controller mappa e inizializza:
- timer di smooth-zoom,
- timer refresh veicoli (se attivo),
- caricamento fermate,
- binding interazioni,
- prima renderizzazione.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#bindConnectionStatus(Model.Net.ConnectionStatusProvider)" class="member-name-link">bindConnectionStatus</a><wbr>(<a href="../../Model/Net/ConnectionStatusProvider.html" title="interface in Model.Net">ConnectionStatusProvider</a>&nbsp;provider)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Collega il controller a un <a href="../../Model/Net/ConnectionStatusProvider.html" title="interface in Model.Net"><code>ConnectionStatusProvider</code></a> per reagire a ONLINE/OFFLINE.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#centerMapOnCluster(Model.Points.ClusterModel)" class="member-name-link">centerMapOnCluster</a><wbr>(<a href="../../Model/Points/ClusterModel.html" title="class in Model.Points">ClusterModel</a>&nbsp;cluster)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Centra la mappa su un cluster e riduce lo zoom di 1 livello (per “aprire” il cluster).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#centerMapOnGtfsStop(Model.Points.StopModel)" class="member-name-link">centerMapOnGtfsStop</a><wbr>(<a href="../../Model/Points/StopModel.html" title="class in Model.Points">StopModel</a>&nbsp;stop)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Variante “robusta” che costruisce la <code>GeoPosition</code> da lat/lon.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#centerMapOnStop(Model.Points.StopModel)" class="member-name-link">centerMapOnStop</a><wbr>(<a href="../../Model/Points/StopModel.html" title="class in Model.Points">StopModel</a>&nbsp;stop)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Centra la mappa su una fermata e imposta uno zoom ravvicinato.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#clearHighlightedStop()" class="member-name-link">clearHighlightedStop</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Rimuove l’evidenziazione della fermata (marker speciale) e ridisegna.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#clearRouteHighlight()" class="member-name-link">clearRouteHighlight</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Rimuove l’evidenziazione delle linee (shape) e ridisegna.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#clearVehicles()" class="member-name-link">clearVehicles</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Disattiva la layer veicoli e ridisegna.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hideUselessStops(java.util.List)" class="member-name-link">hideUselessStops</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../../Model/Points/StopModel.html" title="class in Model.Points">StopModel</a>&gt;&nbsp;stops)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Mostra solo le fermate passate in input, nascondendo tutte le altre.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#highlightRouteAllDirections(java.lang.String)" class="member-name-link">highlightRouteAllDirections</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Evidenzia tutte le shape associate a una route, includendo entrambe le direzioni.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#highlightRouteAllDirectionsKeepStopView(java.lang.String)" class="member-name-link">highlightRouteAllDirectionsKeepStopView</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Evidenzia tutte le direzioni di una route mantenendo centro/zoom invariati (stop-mode).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#highlightRouteFitLine(java.lang.String,java.lang.String)" class="member-name-link">highlightRouteFitLine</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;directionId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Evidenzia una route e adatta (fit) centro/zoom per includere tutta la linea (utile per line-search).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#highlightRouteKeepStopView(java.lang.String,java.lang.String)" class="member-name-link">highlightRouteKeepStopView</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;directionId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Evidenzia una route mantenendo centro/zoom invariati (utile per stop-search: non vogliamo “spostare” l’utente).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#refreshVehiclesLayerIfNeeded()" class="member-name-link">refreshVehiclesLayerIfNeeded</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Aggiorna la layer veicoli solo se è attiva (route selezionata).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#refreshView()" class="member-name-link">refreshView</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Ridisegna la mappa applicando:
- center e zoom attuali del model,
- modalità stops o modalità clusters in base allo zoom,
- shapes evidenziate,
- fermata evidenziata (se presente),
- layer veicoli filtrata (se attiva).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#showAllStops()" class="member-name-link">showAllStops</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Ripristina tutte le fermate dopo un filtro (es. line-search) e ridisegna.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#showVehiclesForRoute(java.lang.String,int)" class="member-name-link">showVehiclesForRoute</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId,
 int&nbsp;directionId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Attiva (o aggiorna) la visualizzazione dei veicoli per una route/direction.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#method-summary" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(Model.Map.MapModel,View.Map.MapView,java.lang.String,Service.GTFS_RT.Fetcher.Vehicle.VehiclePositionsService)">
<h3>MapController</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">MapController</span><wbr><span class="parameters">(<a href="../../Model/Map/MapModel.html" title="class in Model.Map">MapModel</a>&nbsp;model,
 <a href="../../View/Map/MapView.html" title="class in View.Map">MapView</a>&nbsp;view,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;stopsCsvPath,
 <a href="../../Service/GTFS_RT/Fetcher/Vehicle/VehiclePositionsService.html" title="class in Service.GTFS_RT.Fetcher.Vehicle">VehiclePositionsService</a>&nbsp;vehiclePositionsService)</span></div>
<div class="block">Crea il controller mappa e inizializza:
- timer di smooth-zoom,
- timer refresh veicoli (se attivo),
- caricamento fermate,
- binding interazioni,
- prima renderizzazione.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>model</code> - modello mappa (center/zoom/markers)</dd>
<dd><code>view</code> - vista mappa (contiene JXMapViewer e layer)</dd>
<dd><code>stopsCsvPath</code> - path del file stops.csv usato per caricare le fermate</dd>
<dd><code>vehiclePositionsService</code> - service realtime che fornisce i veicoli (cache)</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="centerMapOnStop(Model.Points.StopModel)">
<h3>centerMapOnStop</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">centerMapOnStop</span><wbr><span class="parameters">(<a href="../../Model/Points/StopModel.html" title="class in Model.Points">StopModel</a>&nbsp;stop)</span></div>
<div class="block">Centra la mappa su una fermata e imposta uno zoom ravvicinato.
Inoltre salva la fermata come “evidenziata” così rimane visibile anche in modalità cluster.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>stop</code> - fermata da centrare (deve avere GeoPosition valida)</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="centerMapOnGtfsStop(Model.Points.StopModel)">
<h3>centerMapOnGtfsStop</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">centerMapOnGtfsStop</span><wbr><span class="parameters">(<a href="../../Model/Points/StopModel.html" title="class in Model.Points">StopModel</a>&nbsp;stop)</span></div>
<div class="block">Variante “robusta” che costruisce la <code>GeoPosition</code> da lat/lon.
Usata quando i dati stop arrivano da parsing/ricerca e non hanno già una GeoPosition pronta.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>stop</code> - fermata GTFS (lat/lon devono essere validi)</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="centerMapOnCluster(Model.Points.ClusterModel)">
<h3>centerMapOnCluster</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">centerMapOnCluster</span><wbr><span class="parameters">(<a href="../../Model/Points/ClusterModel.html" title="class in Model.Points">ClusterModel</a>&nbsp;cluster)</span></div>
<div class="block">Centra la mappa su un cluster e riduce lo zoom di 1 livello (per “aprire” il cluster).
Qui aggiorniamo subito anche il viewer per rendere stabile il ricalcolo clustering.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cluster</code> - cluster selezionato</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="refreshView()">
<h3>refreshView</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">refreshView</span>()</div>
<div class="block">Ridisegna la mappa applicando:
- center e zoom attuali del model,
- modalità stops o modalità clusters in base allo zoom,
- shapes evidenziate,
- fermata evidenziata (se presente),
- layer veicoli filtrata (se attiva).

Nota: la scelta stop/cluster è volutamente semplice (soglia su zoomInt) perché è facile da spiegare all’orale.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="clearRouteHighlight()">
<h3>clearRouteHighlight</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">clearRouteHighlight</span>()</div>
<div class="block">Rimuove l’evidenziazione delle linee (shape) e ridisegna.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="hideUselessStops(java.util.List)">
<h3>hideUselessStops</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">hideUselessStops</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../../Model/Points/StopModel.html" title="class in Model.Points">StopModel</a>&gt;&nbsp;stops)</span></div>
<div class="block">Mostra solo le fermate passate in input, nascondendo tutte le altre.
Usa gli ID GTFS (stop_id) per filtrare le fermate già caricate da CSV.

Nota: se la lista è vuota non facciamo nulla per evitare di “svuotare” completamente la mappa.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>stops</code> - lista di fermate da mantenere visibili</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="showAllStops()">
<h3>showAllStops</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">showAllStops</span>()</div>
<div class="block">Ripristina tutte le fermate dopo un filtro (es. line-search) e ridisegna.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="highlightRouteAllDirections(java.lang.String)">
<h3>highlightRouteAllDirections</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">highlightRouteAllDirections</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId)</span></div>
<div class="block">Evidenzia tutte le shape associate a una route, includendo entrambe le direzioni.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>routeId</code> - id della route GTFS</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="highlightRouteFitLine(java.lang.String,java.lang.String)">
<h3>highlightRouteFitLine</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">highlightRouteFitLine</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;directionId)</span></div>
<div class="block">Evidenzia una route e adatta (fit) centro/zoom per includere tutta la linea (utile per line-search).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>routeId</code> - id route</dd>
<dd><code>directionId</code> - id direzione (come stringa per match con i model)</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="highlightRouteKeepStopView(java.lang.String,java.lang.String)">
<h3>highlightRouteKeepStopView</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">highlightRouteKeepStopView</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;directionId)</span></div>
<div class="block">Evidenzia una route mantenendo centro/zoom invariati (utile per stop-search: non vogliamo “spostare” l’utente).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>routeId</code> - id route</dd>
<dd><code>directionId</code> - id direzione</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="highlightRouteAllDirectionsKeepStopView(java.lang.String)">
<h3>highlightRouteAllDirectionsKeepStopView</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">highlightRouteAllDirectionsKeepStopView</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId)</span></div>
<div class="block">Evidenzia tutte le direzioni di una route mantenendo centro/zoom invariati (stop-mode).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>routeId</code> - id route</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="showVehiclesForRoute(java.lang.String,int)">
<h3>showVehiclesForRoute</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">showVehiclesForRoute</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;routeId,
 int&nbsp;directionId)</span></div>
<div class="block">Attiva (o aggiorna) la visualizzazione dei veicoli per una route/direction.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>routeId</code> - route da filtrare</dd>
<dd><code>directionId</code> - direction da filtrare (-1 = tutte)</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="clearVehicles()">
<h3>clearVehicles</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">clearVehicles</span>()</div>
<div class="block">Disattiva la layer veicoli e ridisegna.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="refreshVehiclesLayerIfNeeded()">
<h3>refreshVehiclesLayerIfNeeded</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">refreshVehiclesLayerIfNeeded</span>()</div>
<div class="block">Aggiorna la layer veicoli solo se è attiva (route selezionata).
Nota: qui non fetchiamo la rete; leggiamo la cache del service.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="clearHighlightedStop()">
<h3>clearHighlightedStop</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">clearHighlightedStop</span>()</div>
<div class="block">Rimuove l’evidenziazione della fermata (marker speciale) e ridisegna.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="bindConnectionStatus(Model.Net.ConnectionStatusProvider)">
<h3>bindConnectionStatus</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">bindConnectionStatus</span><wbr><span class="parameters">(<a href="../../Model/Net/ConnectionStatusProvider.html" title="interface in Model.Net">ConnectionStatusProvider</a>&nbsp;provider)</span></div>
<div class="block">Collega il controller a un <a href="../../Model/Net/ConnectionStatusProvider.html" title="interface in Model.Net"><code>ConnectionStatusProvider</code></a> per reagire a ONLINE/OFFLINE.

Comportamento:
- OFFLINE: tile solo offline, layer veicoli disattivata e stop del timer refresh veicoli.
- ONLINE: tile normali, riavvio timer refresh e aggiornamento layer se attiva.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>provider</code> - provider stato connessione</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</body>
</html>
